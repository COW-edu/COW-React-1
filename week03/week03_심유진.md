# DOM과 virtualDOM, MPA vs SPA, CSR vs SSR

### **DOM이란?**

---

> ***DOM은 HTML, XML document와 상호작용하고 표현하는 API이다.***
> 

**DOM이 필요한 이유** 

: 나의 IDE에 HTML을 작성한다 한들, 최종적으로 이 결과물을 보기 위해 브라우저가 필요하다. IDE에 작성된 HTML은 단순한 문자열(string)일 뿐이며, 브라우저가 이해하기 위해서는 노드(객체)로 변환해야 한다. 

**특징**

: 기존에 DOM을 통해 문서에 접근하여 특정 요소를 변경하는 것은, 변경된 해당 요소뿐만 아니라 그 부모 요소 전체를 다시 렌더링하는 등의 특징이 있었기에 속도 면에서 비효율적인 측면이 있었다. 

( DOM이 직접 변경된다면 사소한 변경사항에도 전체가 재렌더링 되기 때문에 브라우저에 과부하가 올 수 있다. 따라서 최대한 DOM에 직접 접근하지 말아야 한다. )

→  때문에 리액트에서는 이를 개선하기 위해 **Virtual DOM**이라는 가상의 DOM을 만들었다. 

---

## Virtual Dom

---

> ***Virtual Dom(이하 가상 DOM)은 수정사항이 여러 가지 있더라도, 가상 DOM은 한 번만 렌더링을 일으킨다.***
> 

**특징**

:  가상 DOM은 DOM이 생성되기 전, 이전 상태 값과 수정사항을 비교하여 달라진 부분만 DOM에게 한 번에 전달하여 **딱 한 번만 렌더링**을 진행한다.

: 가상의 DOM을 구성하는 만큼 메모리 사용량은 늘어난다는 단점은 있지만, 덕분에 더욱 빠른 렌더링 속도를 가지게 되었다.

![image](https://github.com/COW-edu/COW-React-1/assets/98771235/3af49c9b-778d-430f-8663-44354c2b7ead)


---

### MPA (Multi Page Application)

---

> ***탭을 이동할 때마다 새로운 html 페이지를 받아와서 페이지를 새로 렌더링하는 전통적인 웹페이지 구성 방식이다.***
> 

### 작동 방식

- 새로운 페이지를 요청할 때마다 서버에서 렌더링된 정적 리소스(HTML, CSS, JavaScript)가 다운로드된다.
- 페이지 이동하거나 새로고침하면 전체 페이지를 다시 렌더링한다.
- MPA는 SSR(Server Side Application) 방식으로 렌더링한다.

### 장점

1. **SEO 친화적**
    
    MPA를 사용하여 여러 페이지를 생성할 수 있기 때문에 훨씬 더 많은 수의 키워드를 타겟팅할 수 있다.더 많은 페이지로 인해 여러 HTML 파일이 존재하는데, HTML 다운로드하여 페이지를 크롤링하기 때문에 검색 엔진이 작동하는 방식에 더 적합하다.
    
2. **확장성**
    
    다중 페이지로 원하는 만큼 페이지를 추가할 수 있다. 
    

### 단점

1. **페이지 이동 시 느린 속도**
    
    사용자가 새로운 페이지를 이동하면 전체 페이지를 다시 렌더링하기 때문이다. HTML, CSS, JS 와 같은 리소스들이 새로 고쳐져서 속도에 영향을 받는다.
    
2. **복잡한 개발**
    
    개발자는 클라이언트 측과 서버 측 모두에 프레임워크를 사용해야 한다. 그 결과 애플리케이션 개발 시간이 더 길어진다.
    
3. **보안 및 유지보수**
    
    개발자는 모든 페이지가 안전한지 확인 해야하는데 페이지가 많아서 지속적으로 유지보수 하는 것이 어려움.
    

MPA방식 웹 사이트는 인터렉션이 발생할 때마다 완전히 새로운 페이지를 서버에서 전송함. 

점차 웹 사이트가 고도화됨에 따라 한 페이지에 해당하는 페이지 용량이 커져갔고, 매번 새로운 페이지를 전달하는 게 점점 버거워짐. (기존의 웹 애플리케이션은 **돔 전체를 직접 접근**하여 조작해서 브라우저에 화면을 나타내는 방식이었음)

때문에 웹 어플리케이션의 규모가 커질수록 성능 이슈가 발생함. (돔 자체를 읽고 쓰는 것은 빠르지만, 돔에 변화가 일어나 브라우저에서 매번 리플로우/리페인트 되는 과정에서 성능이 저하되는 것)

→ 그렇게  뷰의 변형이 아닌, 기존 뷰를 날리고 새로 렌더링 하는 방법인 **SPA**(Single Page Application)가 나왔다. 웹 사이트의 전체 페이지를 하나의 페이지에 담아 동적으로 화면을 바꿔가는 방식이다.

---

### SPA (Single Page Applicaion)

---

> ***MPA와 반대로 하나의 페이지로 구성된 애플리케이션을 말한다.***
> 

### **작동방식**

- SPA는 웹 에플리케이션에 필요한 모든 정적 리소스를 최초 접근 시 단 한번만 다운로드한다.
- 이후 새로운 페이지 요청 시, 페이지 갱신에 필요한 데이터만을 JSON으로 전달받아 페이지를 갱신한다. 기존 페이지의 내부를 수정해서 보여주는 방식이다.
- SPA를 일반적으로 CSR(Client Side Rendering) 방식으로 렌더링한다고 말한다.

### 장점

1. **속도 및 응답시간**
    
    속도는 전반적인 사용자 경험을 향상시키는 데 중요한 요소이다.
    
    전체 페이지를 다시 렌더링하지 않고 변경되는 부분만을 갱신하므로 새로고침이 발생하지 않아 네이티브 앱과 유사한 사용자 경험을 제공할 수 있다.
    
2. **개발 간소화**
    
    서버에서 페이지를 렌더링하기 위해 코드를 작성할 필요가 없다. 
    

### 단점

1. **초기 구동 속도**
    
    SPA는 웹 애플리케이션에 필요한 모든 정적 리소스를 최초 접근시 단 한번 다운로드하기 때문에 초기 구동 속도가 상대적으로 느리다.
    
2. **SEO(검색엔진 최적화) 이슈**
    
    SPA는 JavaScript로 구축된다.(CSR 방식) 자바스크립트를 읽지 못하는 검색엔진에 대해서 크롤링이 되지않아 색인이 되지 않는 문제가 발생할 수 있다.
    

---

Q . 돔 조작이 빈번한 SPA에서 성능을 향상하는 방법?

 A. Virtual DOM을 사용하는 것이다.  리액트와 뷰와 같은 SPA 라이브러리의 경우, Virtual DOM이라는 패턴을 사용해 SPA를 구현한다. 

+)

가상의 객체 트리로 HTML 정보를 저장하고 있다가, 이 트리에 변경이 발생하면 모든 변화를 모아 리얼 돔과 비교하여 변경된 부분을 한 번에 빠르게 일괄 업데이트한다.

 따라서 리플로우가 적게 발생하게 된다. 작은 규모의 리플로우가 여러 번 발생하는 것보다 큰 규모의 리플로우가 한번 발생하는 것이 성능상으로 훨씬 뛰어나다. 

---

### **웹사이트 로딩은 크게 두 가지로 나눌 수 있다.**

첫 페이지를 로딩하는 것과 나머지를 로딩하는 것. 

SSR과 CSR은 웹사이트 로딩에 필요한 모든 파일을 다운받을지, 필요한 부분만 다운로드할지에 대해 다른 접근 방식을 갖고 있다. 

일반적으로 SPA에서는 **CSR** 방식을 사용하고, MPA는 **SSR** 방식을 사용한다. 

---

### CSR(Client Side Rendering)

---

> ***클라이언트에서 렌더링을 하는 방식***
> 
- 유저가 웹사이트에 방문하면 브라우저가 서버에 콘텐츠를 요청하고 서버는 빈 뼈대만 있는 html을 응답으로 보내준다.
- 브라우저는 연결된 js 링크를 통해 서버로부터 다시 js 파일을 다운로드받고, 이를 이용해 동적으로 페이지를 만들어 띄워준다

### 장점

- 필요한 데이터만 서버에 요청하기 때문에 구동 속도는 빠르다
- 뼈대만 있는 html을 보내주면 되기 때문에 부하가 적다

### 단점

- js 파일을 다운로드 받고 동적으로 dom을 생성하는 시간을 기다려야 하기 때문에 초기 속도는 느리다.
- html에 내용이 텅 비어있기 때문에 검색 엔진이 색인을 할 만한 컨텐츠가 없다.

---

### SSR(Server Side Rendering)

---

> ***서버에서 렌더링을 하는 방식***
> 
- 유저가 웹사이트에 방문하면 브라우저가 서버에 콘텐츠를 요청한다.
- 서버에서는 즉시 페이지에 필요한 데이터를 넣어 모두 삽입하고, css까지 적용해서 렌더링 준비를 마친 html과 js를 전달한다.

### 장점

- js를 다운로드받고 실행하기 전에 사용자가 화면을 볼 수 있어 초기 구동 속도가 빠르다
- CSR과 반대로 모든 콘텐츠가 담겨져있기 때문에 검색 엔진 최적화에 유리함.

### 단점

- js 로직이 연결될 때까지 사용자의 입력에 응답할 수 없다